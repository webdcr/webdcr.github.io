---
layout: default
title: Home
permalink: /
preload_listen_icon_hover: true
---

<div class="home-content">
  <img
    src="/assets/images/wdcr-fish.gif"
    alt="WebDCR fish"
    class="home-logo"
  />
  <h1>Radio of, by, and for the students.</h1>
  <button class="button listen-button" id="listenButton" type="button">
    <span class="listen-button-content">
      <span class="listen-button-label">Listen live</span>
      <img
        src="/assets/images/hand1.png"
        alt=""
        class="listen-button-icon"
        aria-hidden="true"
        data-hover-src="/assets/images/hand2.png"
      />
    </span>
  </button>
  <img
    src="/assets/images/hand1.png"
    alt=""
    class="listen-button-cursor"
    id="listenButtonCursor"
    aria-hidden="true"
  />

  <h2>Show Schedule</h2>
  <p class="schedule-term">({{ site.term }})</p>
  <div class="day-selector-group">
    <button class="selectDay" id="selectDay_Sunday" data-day="Sunday" type="button">
      sunday
    </button>
    <button class="selectDay" id="selectDay_Monday" data-day="Monday" type="button">
      monday
    </button>
    <button class="selectDay" id="selectDay_Tuesday" data-day="Tuesday" type="button">
      tuesday
    </button>
    <button class="selectDay" id="selectDay_Wednesday" data-day="Wednesday" type="button">
      wednesday
    </button>
    <button class="selectDay" id="selectDay_Thursday" data-day="Thursday" type="button">
      thursday
    </button>
    <button class="selectDay" id="selectDay_Friday" data-day="Friday" type="button">
      friday
    </button>
    <button class="selectDay" id="selectDay_Saturday" data-day="Saturday" type="button">
      saturday
    </button>
  </div>

  {% assign days = "Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday" |
  split: "," %} {% for day in days %} {% assign showsThisDay = site.data.shows |
  where: "Day", day %} {% assign showsThisDay = showsThisDay | sort: 'Time' %}
  <div class="daydiv" id="daydiv_{{ day }}">
    <h2>{{ day }}</h2>
    {% if showsThisDay.size > 0 %}
    <table class="schedule-table">
      {% for row in showsThisDay %}
      <tr
        class="showRow"
        data-day="{{ day }}"
        data-time="{{ row['Time'] | strip | escape }}"
      >
        <td class="showRowImage">
          {% if row["Image name"] %}
          <img
            src="/assets/images/showalbums/{{ row['Image name'] | strip | uri_escape }}"
            alt="{{ row["Name"] }} artwork"
          />
          {% else %}
          <img
            src="/assets/images/showalbums/placeholder.png"
            alt="{{ row["Name"] }} placeholder artwork"
          />
          {% endif %}
        </td>
        <td class="showRowInfo">
          <span class="showRowName">{{ row["Name"] }}</span>
          {% if row["Host(s)"] %}
          <span class="showRowHost">with {{ row["Host(s)"] }}</span>
          {% endif %}
          <p class="showRowDescription">{{ row["Description"] }}</p>
        </td>
        {% assign timeString = '2000-01-01 ' | append: row['Time'] %}
        {% assign displayTime = timeString | date: '%-I:%M %p' %}
        <td class="showRowTime">
          <span class="showRowTimeContent">
            <span class="showRowTimeText">{{ displayTime }}</span>
          </span>
        </td>
      </tr>
      {% endfor %}
    </table>
    {% else %}
    <p>No shows scheduled.</p>
    {% endif %}
  </div>
  {% endfor %}

  <img class="circle-image" src="/assets/images/shirts.jpg" alt="WebDCR merchandise" />
</div>

<script>
  (function () {
    const daySelectors = document.querySelectorAll(".selectDay");
    const daysOfWeek = [
      "Sunday",
      "Monday",
      "Tuesday",
      "Wednesday",
      "Thursday",
      "Friday",
      "Saturday"
    ];
    let activeDay = "";

    function showDay(day) {
      if (!day || day === activeDay) {
        return;
      }

      const nextPanel = document.getElementById(`daydiv_${day}`);
      const nextButton = document.getElementById(`selectDay_${day}`);

      if (!nextPanel || !nextButton) {
        return;
      }

      nextPanel.style.display = "block";
      nextButton.classList.add("selectedSelectDay");

      if (activeDay) {
        const prevPanel = document.getElementById(`daydiv_${activeDay}`);
        const prevButton = document.getElementById(`selectDay_${activeDay}`);
        if (prevPanel) {
          prevPanel.style.display = "none";
        }
        if (prevButton) {
          prevButton.classList.remove("selectedSelectDay");
        }
      }

      activeDay = day;
    }

    daySelectors.forEach((button) => {
      button.addEventListener("click", () => {
        showDay(button.dataset.day);
      });
    });

    const todayIndex = new Date().getDay();
    const todayName = daysOfWeek[todayIndex] || daysOfWeek[0];
    showDay(todayName);

    const listenButton = document.getElementById("listenButton");
    const radioPlayerButton = document.getElementById("radioPlayer");
    if (listenButton) {
      listenButton.setAttribute("aria-disabled", "false");
      listenButton.addEventListener("click", () => {
        if (!radioPlayerButton) {
          return;
        }
        if (radioPlayerButton.getAttribute("data-mode") === "stopped") {
          radioPlayerButton.click();
        } else {
          radioPlayerButton.focus();
        }
      });

      const listenIcon = listenButton.querySelector(".listen-button-icon");
      if (listenIcon) {
        const defaultSrc = listenIcon.getAttribute("src");
        const hoverSrc = listenIcon.dataset.hoverSrc;
        const setIcon = (src) => {
          if (!src) {
            return;
          }
          if (listenButton.classList.contains("listen-button--active")) {
            if (src === hoverSrc || src === defaultSrc) {
              return;
            }
          }
          listenIcon.setAttribute("src", src);
        };

        if (hoverSrc) {
          const releasePointerCapture = (event) => {
            if (
              event &&
              typeof listenButton.releasePointerCapture === "function" &&
              event.pointerId !== undefined
            ) {
              try {
                listenButton.releasePointerCapture(event.pointerId);
              } catch (err) {}
            }
          };

          const resetIcon = (event) => {
            setIcon(defaultSrc);
            releasePointerCapture(event);
          };

          listenButton.addEventListener("pointerdown", (event) => {
            if (event.pointerType === "mouse" && event.button !== 0) {
              return;
            }
            if (
              typeof listenButton.setPointerCapture === "function" &&
              event.pointerId !== undefined
            ) {
              try {
                listenButton.setPointerCapture(event.pointerId);
              } catch (err) {}
            }
            setIcon(hoverSrc);
          });

          ["pointerup", "pointercancel", "pointerleave"].forEach((evt) => {
            listenButton.addEventListener(evt, resetIcon);
          });

          listenButton.addEventListener("mouseleave", resetIcon);

          listenButton.addEventListener("keydown", (event) => {
            if (event.key === "Enter" || event.key === " ") {
              setIcon(hoverSrc);
            }
          });

          listenButton.addEventListener("keyup", (event) => {
            if (event.key === "Enter" || event.key === " ") {
              setIcon(defaultSrc);
            }
          });

          listenButton.addEventListener("blur", resetIcon);
        }
      }

      const rawCursorEl = document.getElementById("listenButtonCursor");
      const hasFinePointer =
        typeof window.matchMedia === "function"
          ? window.matchMedia("(pointer: fine)").matches
          : true;
      const cursorEl = hasFinePointer ? rawCursorEl : null;
      if (rawCursorEl && !cursorEl) {
        rawCursorEl.style.display = "none";
      }
      const buttonIcon = listenButton.querySelector(".listen-button-icon");
      const updateCursorStyle = () => {
        const isActive = listenButton.classList.contains("listen-button--active");
        const handSrc = isActive ? "/assets/images/hand1-gray.png" : "/assets/images/hand1.png";
        if (cursorEl) {
          cursorEl.src = handSrc;
        }
        if (buttonIcon) {
          buttonIcon.src = handSrc;
        }
      };

      const updateListenButtonVisualState = () => {
        if (!radioPlayerButton) {
          listenButton.classList.remove("listen-button--active");
          listenButton.setAttribute("aria-disabled", "false");
          updateCursorStyle();
          return;
        }
        const mode = radioPlayerButton.getAttribute("data-mode");
        const isActive = mode === "playing" || mode === "loading";
        listenButton.classList.toggle("listen-button--active", isActive);
        listenButton.disabled = !!isActive;
        listenButton.setAttribute("aria-disabled", isActive ? "true" : "false");
        updateCursorStyle();
      };

      if (radioPlayerButton) {
        if (typeof MutationObserver !== "undefined") {
          const observer = new MutationObserver((mutations) => {
            for (const mutation of mutations) {
              if (mutation.type === "attributes" && mutation.attributeName === "data-mode") {
                updateListenButtonVisualState();
                break;
              }
            }
          });
          observer.observe(radioPlayerButton, {
            attributes: true,
            attributeFilter: ["data-mode"]
          });
        } else {
          setInterval(updateListenButtonVisualState, 1000);
        }

        updateListenButtonVisualState();
      }

      if (cursorEl) {
        const moveCursorTo = (x, y) => {
          cursorEl.style.left = x + "px";
          cursorEl.style.top = y + "px";
        };

        const setCursorPosition = (x, y, instant = false) => {
          if (instant) {
            cursorEl.classList.add("listen-button-cursor--no-transition");
            moveCursorTo(x, y);
            void cursorEl.offsetWidth;
            cursorEl.classList.remove("listen-button-cursor--no-transition");
          } else {
            moveCursorTo(x, y);
          }
        };

        const getCursorAnchorPosition = () => {
          const target = buttonIcon || listenButton;
          const rect = target.getBoundingClientRect();
          return {
            x: rect.left + rect.width / 2,
            y: rect.top + rect.height / 2
          };
        };

        const moveCursorToAnchor = (instant = false) => {
          const { x, y } = getCursorAnchorPosition();
          setCursorPosition(x, y, instant);
        };

        moveCursorToAnchor(true);

        let cursorHideTimeout;

        listenButton.addEventListener("mouseenter", (event) => {
          if (cursorHideTimeout) {
            clearTimeout(cursorHideTimeout);
            cursorHideTimeout = undefined;
          }
          moveCursorToAnchor(true);
          cursorEl.classList.add("visible");
          requestAnimationFrame(() => {
            setCursorPosition(event.clientX, event.clientY);
          });
          updateCursorStyle();
        });

        listenButton.addEventListener("mouseleave", () => {
          moveCursorToAnchor();
          cursorHideTimeout = setTimeout(() => {
            cursorEl.classList.remove("visible");
            cursorEl.src = "/assets/images/hand1.png";
          }, 80);
        });

        listenButton.addEventListener("mousemove", (e) => {
          setCursorPosition(e.clientX, e.clientY);
        });

        listenButton.addEventListener("mousedown", () => {
          if (!listenButton.classList.contains("listen-button--active")) {
            cursorEl.src = "/assets/images/hand2.png";
          }
        });

        listenButton.addEventListener("mouseup", () => {
          const handSrc = listenButton.classList.contains("listen-button--active")
            ? "/assets/images/hand1-gray.png"
            : "/assets/images/hand1.png";
          cursorEl.src = handSrc;
        });

        window.addEventListener("resize", () => {
          if (!cursorEl.classList.contains("visible")) {
            moveCursorToAnchor(true);
          }
        });
      }
    }

    function parseTimeToDecimal(timeString) {
      if (!timeString) {
        return NaN;
      }

      const trimmed = timeString.trim();
      const twentyFourHourMatch = trimmed.match(/^(\d{1,2}):(\d{2})$/);
      if (twentyFourHourMatch) {
        const hours = parseInt(twentyFourHourMatch[1], 10);
        const minutes = parseInt(twentyFourHourMatch[2], 10);
        if (hours < 24 && minutes < 60) {
          return hours + minutes / 60;
        }
      }

      const twelveHourMatch = trimmed.match(/(\d{1,2})(?::(\d{2}))?\s*(AM|PM)/i);
      if (!twelveHourMatch) {
        return NaN;
      }
      let hours = parseInt(twelveHourMatch[1], 10);
      const minutes = twelveHourMatch[2]
        ? parseInt(twelveHourMatch[2], 10)
        : 0;
      const meridiem = twelveHourMatch[3].toUpperCase();
      if (meridiem === "PM" && hours < 12) {
        hours += 12;
      }
      if (meridiem === "AM" && hours === 12) {
        hours = 0;
      }
      return hours + minutes / 60;
    }

    function highlightCurrentShow() {
      const now = new Date();
      const currentDay = daysOfWeek[now.getDay()];
      const nowDecimal = now.getHours() + now.getMinutes() / 60;
      let foundLiveShow = false;

      document.querySelectorAll(".showRow--live").forEach((row) => {
        row.classList.remove("showRow--live");
      });

      document
        .querySelectorAll(`.showRow[data-day="${currentDay}"]`)
        .forEach((row) => {
          const showStart = parseTimeToDecimal(row.dataset.time);
          if (Number.isNaN(showStart)) {
            return;
          }
          if (nowDecimal >= showStart && nowDecimal < showStart + 1) {
            row.classList.add("showRow--live");
            foundLiveShow = true;
          }
        });

    }

    highlightCurrentShow();
    setInterval(highlightCurrentShow, 300000);
  })();
</script>
